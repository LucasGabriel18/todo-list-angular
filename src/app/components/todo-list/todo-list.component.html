<div class="container-lista-tarefas">
    <div class="cabecalho-tarefas">
        <div class="estatisticas">
            <div class="item-estatistica">
                <span class="numero-estatistica">{{ contadorTotal() }}</span>
                <span class="label-estatistica">Total</span>
            </div>
            <div class="item-estatistica">
                <span class="numero-estatistica">{{ contadorPendentes() }}</span>
                <span class="label-estatistica">Pendentes</span>
            </div>
            <div class="item-estatistica">
                <span class="numero-estatistica">{{ contadorConcluidas() }}</span>
                <span class="label-estatistica">Conclu√≠das</span>
            </div>
        </div>

        @if (contadorTotal() > 0) {
        <div class="container-progresso">
            <div class="barra-progresso">
                <div class="preenchimento-progresso" [style.width.%]="obterPorcentagemProgresso()">
                </div>
            </div>
            <span class="texto-progresso">{{ obterPorcentagemProgresso() }}% conclu√≠do</span>
        </div>
        }
    </div>

    <div class="formulario-adicionar-tarefa">
        <div class="grupo-input">
            <input type="text" [(ngModel)]="textoNovaTarefa" (keydown)="aoTeclarEnter($event)"
                placeholder="Digite uma nova tarefa..." class="input-tarefa" maxlength="200">

            <select [(ngModel)]="prioridadeNovaTarefa" class="selecao-prioridade">
                <option value="baixa">Baixa</option>
                <option value="media">M√©dia</option>
                <option value="alta">Alta</option>
            </select>

            <button (click)="adicionarTarefa()" [disabled]="!textoNovaTarefa().trim()" class="btn btn-adicionar">
                Adicionar
            </button>
        </div>
    </div>

    <div class="filtros">
        <button (click)="definirFiltro('todas')" [class]="'btn btn-filtro ' + obterClasseFiltro('todas')">
            Todas ({{ contadorTotal() }})
        </button>
        <button (click)="definirFiltro('pendentes')" [class]="'btn btn-filtro ' + obterClasseFiltro('pendentes')">
            Pendentes ({{ contadorPendentes() }})
        </button>
        <button (click)="definirFiltro('concluidas')" [class]="'btn btn-filtro ' + obterClasseFiltro('concluidas')">
            Conclu√≠das ({{ contadorConcluidas() }})
        </button>
    </div>

    @if (tarefasOrdenadas().length > 0) {
    <div class="lista-tarefas">
        @for (tarefa of tarefasOrdenadas(); track rastrearPorIdTarefa($index, tarefa)) {
        <app-item-tarefa [tarefa]="tarefa" (alternar)="aoAlternarTarefa($event)" (excluir)="aoExcluirTarefa($event)"
            (atualizar)="aoAtualizarTarefa($event)" (atualizarPrioridade)="aoAtualizarPrioridadeTarefa($event)">
        </app-item-tarefa>
        }
    </div>
    } @else {
    <div class="estado-vazio">
        <div class="icone-vazio">üìù</div>
        <h3>{{ obterTituloEstadoVazio() }}</h3>
        <p>{{ obterMensagemEstadoVazio() }}</p>
    </div>
    }

    @if (contadorTotal() > 0) {
    <div class="acoes-lote">
        <button (click)="marcarTodasComoConcluidas()" [disabled]="contadorPendentes() === 0" class="btn btn-lote">
            Marcar todas como conclu√≠das
        </button>
        <button (click)="excluirTodasConcluidas()" [disabled]="contadorConcluidas() === 0"
            class="btn btn-lote btn-perigo">
            Excluir conclu√≠das
        </button>
        <button (click)="limparTodasTarefas()" class="btn btn-lote btn-perigo">
            Limpar tudo
        </button>
    </div>
    }
</div>